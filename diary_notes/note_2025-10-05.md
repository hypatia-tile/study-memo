# 2025-10-05

This is a temporary note for my daily learning.
Contents will be moved to other places later.
    
## Nix

Nix is a powerful tool which takes a unique approach to package management and system configuration.
So we can make **reproducible**, **declarative**, and **reliable** systems with it.
See also: [NixOS](https://nixos.org/).

### Installation on macOS

We will explain how to install Nix on a macOS system.

To install the latest version Nix, run the following command:
```bash
curl -L https://nixos.org/nix/install | sh
```

On macOS, **multi-user installation** is recommended.

### What is multi-user installation?

The multi-user Nix installation craete system users and a system service for the Nix daemon.

To explicitly instruct the installer to perform a multi-user installation on your system:
```bash
$ bash <(curl -L https://nixos.org/nix/install) --daemon
```

### (Degression) Informal Image (relationship between Nix, Devbox, and Direnv)

* Installer for Devbox internally uses Nix to install packages.
* Direnv is a tool to manage environment variables for different projects.
  so we can use Direnv to automatically load the environment variables set by Devbox when we enter a project directory.

### Post-installation steps

Refer to the official documentation for post-installation steps: [Ad hoc shell environments](https://nix.dev/tutorials/first-steps/ad-hoc-shell-environments)

In a Nix shell environment, you can immediately use any program packaged with Nix,
without installing it permanently.

You can also share the command invoking such a shell with others,
and it will work on all Linux distributions, WSL, and macOS.

### Create a shell environment

Once you install Nix, you can use it to create new shell environments with programs that you want to use.

In this section you will run two exotic programs called `cowsay` and `lolcat` that you will probably not have installed on your machine:
```bash
$ cowsay hello nix
zsh: command not found: cowsay
$ echo no chance | lolcat
zsh: command not found: lolcat
```
To run these programs, you can use the `nix shell` command to create a temporary shell environment with these programs available:
```bash
$ nix shell -p
[nix-shell:~] $ cowsay Hello Nix | lolcat
 ___________
< Hello Nix >
 -----------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
```

### Garbage collection

If you're done trying out Nix for now, you may want to free up some disk space
occupied by the different versions of programs you downloaded by running the example.
```bash
$ nix-collect-garbage
```